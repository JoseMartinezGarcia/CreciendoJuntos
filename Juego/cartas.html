<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Juego de Memoria de Ciencias Naturales</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/phaser/3.55.2/phaser.min.js"></script>
    <style>
        body {
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #e6f7ff;
            overflow: hidden;
        }
    </style>
</head>
<body>
    <script>
        const config = {
            type: Phaser.AUTO,
            width: 800,
            height: 600,
            scene: {
                preload: preload,
                create: create,
                update: update
            }
        };

        let game = new Phaser.Game(config);
        let cards, firstCard, secondCard;
        let canFlip = true;
        let matchedPairs = 0;

        const images = ['lobo', 'pez', 'rosa', 'cactus', 'tormenta', 'terremoto'];
        const descriptions = {
            'lobo': 'El lobo es un mamífero que vive en manadas y habita bosques y montañas.',
            'pez': 'El pez vive en el agua y respira mediante branquias.',
            'rosa': 'La rosa es una flor que florece en primavera y tiene pétalos coloridos.',
            'cactus': 'El cactus crece en zonas desérticas y almacena agua para sobrevivir.',
            'tormenta': 'La tormenta eléctrica causa relámpagos y truenos.',
            'terremoto': 'Un terremoto ocurre cuando la tierra tiembla debido a movimientos de placas tectónicas.'
        };

        function preload() {
            // Carga de imágenes
            this.load.image('background','assets/fondonum.jpg')
            this.load.image('back', 'assets/cartas/back.jpg');  // Imagen del dorso de la carta
            this.load.image('lobo', 'Juego/assets/cartas/lobo.jpg');
            this.load.image('pez', 'Juego/assets/cartas/pez.jpg');
            this.load.image('rosa', 'Juego/assets/cartas/rosa.jpg');
            this.load.image('cactus', 'Juego/assets/cartas/cactus.jpg');
            this.load.image('tormenta', 'Juego/assets/cartas/tormenta.jpg');
            this.load.image('terremoto', 'Juego/assets/cartas/terremoto.jpg');
        }

        function create() {

            // Agregar la imagen de fondo, asegurándote de que ocupe toda la pantalla
            bg = this.add.image(0, 0, 'background').setOrigin(0, 0);
            bg.setDisplaySize(this.sys.game.config.width, this.sys.game.config.height);

            // Crear y barajar cartas
            let shuffledImages = Phaser.Utils.Array.Shuffle([...images, ...images]);
            cards = this.add.group();

            for (let i = 0; i < shuffledImages.length; i++) {
                let x = 100 + (i % 4) * 150;
                let y = 100 + Math.floor(i / 4) * 200;
                let card = this.add.sprite(x, y, 'back').setInteractive();
                card.data = { id: shuffledImages[i], isFlipped: false };
                card.on('pointerdown', () => flipCard(card, this));
                cards.add(card);
            }
        }

        function update() {
            // No se necesita actualización constante
        }

        function flipCard(card, scene) {
            if (!canFlip || card.data.isFlipped) return;

            card.setTexture(card.data.id);
            card.data.isFlipped = true;

            if (!firstCard) {
                firstCard = card;
            } else {
                secondCard = card;
                canFlip = false;
                checkMatch(scene);
            }
        }

        function checkMatch(scene) {
            if (firstCard.data.id === secondCard.data.id) {
                scene.time.delayedCall(500, () => {
                    showDescription(firstCard.data.id, scene);
                    resetCards();
                    matchedPairs++;
                    if (matchedPairs === images.length) {
                        endGame(scene);
                    }
                });
            } else {
                scene.time.delayedCall(1000, () => {
                    firstCard.setTexture('back');
                    secondCard.setTexture('back');
                    resetCards();
                });
            }
        }

        function showDescription(id, scene) {
            const text = descriptions[id];
            const infoText = scene.add.text(400, 550, text, { font: '20px Arial', fill: '#000' }).setOrigin(0.5);
            scene.time.delayedCall(2000, () => infoText.destroy());
        }

        function resetCards() {
            firstCard = null;
            secondCard = null;
            canFlip = true;
        }

        function endGame(scene) {
            scene.add.text(400, 300, '¡Juego Terminado!', { font: '40px Arial', fill: '#00f' }).setOrigin(0.5);
        }
    </script>
</body>
</html>
